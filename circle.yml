machine:
  python:
    version: 3.4.3
  services:
    - rabbitmq-server
  environment:
    IMAGE_TAG: ${CIRCLE_SHA1}
  pre:
    - curl http://www.rabbitmq.com/community-plugins/v3.6.x/rabbitmq_delayed_message_exchange-0.0.1.ez > $RABBITMQ_PLUGINS_DIR/rabbitmq_delayed_message_exchange-0.0.1.ez
    - sudo rabbitmq-plugins enable rabbitmq_management
    - sudo rabbitmq-plugins enable rabbitmq_delayed_message_exchange

dependencies:
  pre:
    - pip install -U pip setuptools tox
    - pip install -e ".[dev]"
    - pyenv local 2.7.10 3.3.6 3.4.3

test:
    override:
      - tox
